import { OwaspParser } from "../src/owaspParser";
import { TestConsole } from "./testConsole";

test(`Parse OWASP file`, () => {
  const testConsole = new TestConsole();
  const parser = new OwaspParser(testConsole);
  const tree = parser.parse({
    sourceReport: "tests/data/dependency-check-report.json",
    dependencies: "tests/data/dependencies.txt",
    exclude: [],
    include: [],
  });
  expect(tree).toMatchSnapshot();
  expect(testConsole.errorLines).toHaveLength(0);
});
