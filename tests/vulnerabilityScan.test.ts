import { VulnerabilityScan } from "../src/vulnerabilityScan";
import { TestConsole } from "./testConsole";

test(`Scan`, () => {
  const testConsole = new TestConsole();
  const scan = new VulnerabilityScan(
    {
      sourceReport: "tests/data/ossIndexAuditScan.txt",
      outputFile: "tests/data/output.txt",
      dependencies: "",
      teamcity: true,
      include: [],
      exclude: [],
    },
    testConsole
  );
  scan.run();
  expect(testConsole.errorLines).toHaveLength(0);
});
