export interface ICommandOptions {
  /**
   * File with report from sonatype
   */
  sourceReport: string;

  /**
   * Output prefix for file reports
   */
  output?: string;

  /**
   * Name of project for reports
   */
  projectName: string;

  /**
   * Internal projects will be exlucluded, defiend by reg expr
   */
  projectInternal: string[];

  /**
   * Dependencies of project if not provided by ossIndex scan
   */
  dependencies?: string;

  /**
   * Report is in TeamCity format
   */
  teamcity?: boolean;

  /**
   * Results will include only libraries with this regexp patterns
   */
  include: string[];

  /**
   * Results will exclude libraries with this regexp patterns
   */
  exclude: string[];
}

export interface INode {
  library: string;
  version: string;
  level: number;
  vulnerabilities: IVulnerability[];
  childNodes: INode[];
}

export interface IVulnerability {
  cve?: string;
  cwe?: string;
  title: string;
  importance: string;
  url: string;
}

export type IVulnerabilities = { [vulnerabilityUrlOrCve: string]: IVulnerableOccurrence };

export interface IVulnerableOccurrence {
  key: string;
  vulnerability: IVulnerability;
  usedBy: ILibraryPath[];
}

export type ILibraryPath = string[];

export interface IConsole {
  log(...args: string[]): void;
  error(...args: string[]): void;
}

export interface IParser {
  parse(options: ICommandOptions): INode[];
}
